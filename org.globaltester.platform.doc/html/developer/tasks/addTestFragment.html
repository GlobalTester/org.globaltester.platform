<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<title>Add a new test fragment</title>
</head>

<body>
	<h1>Add a new Test Fragment</h1>
	<p>
		After you created a new plug-in to implement new functionality within
		GlobalTester you most certainly want to implement a test fragment as
		well. As explained in our <a href="../concepts/devGuidelines.html">development
			guidelines</a> a test fragment (e.g. for JUnit tests) is required for
		most plug-ins that exists in GlobalTester repository.
	</p>

	<h2>Create test fragment and code</h2>
	<p>To create a new fragment project from scratch start the "New
		Project" wizard. In Eclipse, select "Package Explorer" view "New >
		Project > Plug-in Development" and there use "Fragment Project" and
		click "Next".</p>
	<p>
		Now fill in the project name, fragment ID, related data and the
		required host plug-in. You will find several hints regarding the
		values to use here in our <a href="../concepts/devGuidelines.html">development
			guidelines</a> again.
	</p>
	<p>When the basic fragment structure is created you can start to
		implement the code and testcases. CI builds on Jenkins require tests
		to be implemented as JUnit-Tests optionally using SWTBot for
		GUI-Testing. You can define as much test cases and test suites as you
		want. For integration in CI builds you should define at least two
		suites; one full test suite containing all available tests and one
		smoke test suite that contains only a minimal set of tests to verify
		overall functionality.</p>
	<p>For your fragment code to be available during execution and
		Buckminster provisioning the fragment it must be added to a test
		feature that is referenced from the Buckminster entry point.</p>

	<h2>Configure required launch configurations</h2>
	<p>For each of the required test suites an according launch
		configuration is needed. These launch configurations are stored inside
		the fragment and therefore available to all developers and the CI
		build. This ensures that every developer can test his changes in
		exactly the same environment as the product build. To store an
		existing launch configuration inside a workspace project use the "Save
		as" group on the "Common" tab of the launch configuration dialog.</p>
	<p>
		Launch configurations should be named according to the project with an
		additional suffix like
		<code>.full</code>
		or
		<code>.smoke</code>
		. Use only launch configurations of type "JUnit plug-in test", as
		these are the only ones that can be executed by Jenkins. To run
		SWTBot-Tests you can use ordinary JUnit launch configurations with the
		"Run in UI thread" option disabled. As "Program to run" select either
		"Run an application -> Headless Mode" to execute non-ui test suites or
		"Run a product -> org.globaltester.rcp.product" for SWTBot tests. The
		later option ensures that all product defined options (e.g. menu and
		window names) are consistently defined when running tests. Also make
		sure that the launch configuration includes "All available plug-ins"
		as GlobalTester should not interfere with any other available
		plug-ins.
	</p>
	<h2>Add launch configurations to Buckminster scripts and integrate
		projects in CI</h2>
	<p>
		Currently the scripts executed during the CI-Builds on Jenkins are
		still maintained manually. They are located in
		<code>com.hjp.globaltester.releng</code>
		in
		<code> globaltester_rcp.headless</code>
		and you need to add lines like the following to them (somewhere after
		the build command):
	</p>
	<p>
		<code>junit -l
			org.globaltester.core.test/org.globaltester.core.test.full.launch
			--flatXML -o junit/org.globaltester.core.xml</code>
	</p>
	<p>
		After the fragment is referenced from a feature used by Buckminster it
		will be materialized in the corresponding CI-workspaces autmatically.
		In order to rebuild CI-Projects also on changes in the test fragments
		these fragments need to be referenced from the CI-Projects
		configuration. This step is similar for fragments as for plug-ins and
		is described in <a href="addPlugin.html">"Add a new plug-in"</a>.
	</p>
	<p>Sometime in the future we plan to replace those scripts by
		automatically generated ones so that this step will become needless.</p>
</body>
</html>